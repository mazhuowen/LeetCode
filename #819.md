[toc]

```java
class Solution {
    public String mostCommonWord(String paragraph, String[] banned) {
        if (paragraph == null || paragraph.isEmpty()) return null;

        Map<String, Integer> counter = new HashMap<>();
        for (String ban : banned) counter.put(ban, -1);

        char[] seqs = paragraph.toCharArray();
        StringBuffer sb = new StringBuffer();
        int maxCount = 0;
        String maxStr = null;
        for (int i = 0; i < seqs.length; i++) {
            if (Character.isLetter(seqs[i])) {
                // 将字符转化为小写字符
                sb.append(Character.toLowerCase(seqs[i]));
            } else {
                String word = sb.toString();
                // 计数（单词非空且不是禁用词）
                if (!word.isEmpty() && counter.getOrDefault(word, 0) != -1) {
                    counter.put(word, counter.getOrDefault(word, 0) + 1);

                    if (counter.get(word) > maxCount
                            || counter.get(word) == maxCount && word.compareTo(maxStr) < 0) {
                        maxCount = counter.get(word);
                        maxStr = word;
                    }
                }
                sb = new StringBuffer();
            }
        }
        if (sb.length() != 0) {
            String word = sb.toString();
            if (counter.getOrDefault(word, 0) != -1) {
                counter.put(word, counter.getOrDefault(word, 0) + 1);

                if (counter.get(word) > maxCount
                        || counter.get(word) == maxCount && word.compareTo(maxStr) < 0) {
                    maxCount = counter.get(word);
                    maxStr = word;
                }
            }
        }
        return maxStr;
    }
}
```
